{% extends 'base.html.twig' %}

{% block title %}G√©rer le Store
{% endblock %}


{% block main %}
	<div class="d-flex justify-content-between align-items-center mb-4 flex-wrap gap-2">
		<a href="{{ path('dashboard') }}" class="btn btn-secondary">‚Üê Retour au Dashboard</a>
		<h1 class="mb-0 text-danger">üõí G√©rer le Store</h1>
	</div>

	<div class="card bg-dark border border-danger mb-5 p-4 no-lift">
		<h3 class="mb-3 text-danger">‚ûï Ajouter un nouveau produit</h3>

		{{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': 'novalidate'}}) }}
			<div class="row g-3">
				<div class="col-md-6">
					{{ form_row(form.name, {'attr': {'class': 'form-control'}}) }}
				</div>
				<div class="col-md-6">
					{{ form_row(form.type, {'attr': {'class': 'form-select'}}) }}
				</div>
				<div class="col-md-6">
					{{ form_row(form.price, {'attr': {'class': 'form-control', 'step': '0.01', 'min': '0'}}) }}
				</div>
				<div class="col-md-6">
					{{ form_row(form.imageFile) }}
				</div>
				<div class="col-12">
					{{ form_row(form.description, {'attr': {'class': 'form-control', 'rows': 4}}) }}
				</div>
			</div>
			<button type="submit" class="btn btn-danger mt-3">Ajouter le produit</button>
		{{ form_end(form) }}
	</div>

	<h3 class="mb-3 text-danger">üì¶ Produits existants</h3>

	{% if products is not empty %}
		<div class="table-responsive">
			<table class="table table-striped table-hover align-middle">
				<thead class="table-dark">
					<tr>
						<th>ID</th>
						<th>Nom</th>
						<th>Type</th>
						<th>Prix (‚Ç¨)</th>
						<th>Description</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody>
					{% for product in products %}
						<tr>
							<td><strong>{{ product.id }}</strong></td>
							<td>{{ product.name }}</td>
							<td>
								<span class="badge text-bg-info">
									{% if product.type.value == 'merch' %}
										Merchandising
									{% elseif product.type.value == 'accessoire' %}
										Accessoire
									{% elseif product.type.value == 'vetement' %}
										V√™tement
									{% else %}
										{{ product.type.value }}
									{% endif %}
								</span>
							</td>
							<td><strong class="text-danger">{{ product.price|number_format(2, ',', ' ') }}‚Ç¨</strong></td>
							<td>
								{% if product.description %}
									{{ product.description|length > 50 ? product.description|slice(0, 50) ~ '...' : product.description }}
								{% else %}
									<em class="text-light-emphasis">Pas de description</em>
								{% endif %}
							</td>
							<td class="d-flex gap-2 flex-wrap">
								<a href="{{ path('store_edit', {'id': product.id}) }}" class="btn btn-sm btn-warning">‚úèÔ∏è Modifier</a>
								<a href="{{ path('store_delete', {'id': product.id}) }}" class="btn btn-sm btn-danger" onclick="return confirm('√ätes-vous s√ªr ?')">üóëÔ∏è Supprimer</a>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	{% else %}
		<div class="alert alert-info" role="alert">Aucun produit pour le moment. Cr√©ez le premier ci-dessus.</div>
	{% endif %}
{% endblock %}

