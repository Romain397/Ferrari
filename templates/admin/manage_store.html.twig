{% extends 'base.html.twig' %}

{% block title %}G√©rer le Store
{% endblock %}

{% block main %}
	<div class="mb-4">
		<a href="{{ path('dashboard') }}" class="btn btn-secondary">‚Üê Retour au Dashboard</a>
	</div>
	<h1 class="mb-4 text-center text-danger">üõí G√©rer le Store</h1>

	<!-- FORMULAIRE DE CR√âATION -->
	<div class="card bg-dark border-danger mb-5 p-4">
		<h3 class="mb-3 text-danger">‚ûï Ajouter un nouveau produit</h3>

		{{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': 'novalidate'}}) }}

			<div class="row mb-3">
				<div class="col-md-6">
					{{ form_row(form.name, {'attr': {'class': 'form-control'}}) }}
				</div>
				<div class="col-md-6">
					{{ form_row(form.type, {'attr': {'class': 'form-select'}}) }}
				</div>
			</div>

			<div class="row mb-3">
				<div class="col-md-6">
					{{ form_row(form.price, {'attr': {'class': 'form-control', 'step': '0.01', 'min': '0'}}) }}
				</div>
				<div class="col-md-6">
					{{ form_row(form.image, {'attr': {'class': 'form-control'}}) }}
				</div>
			</div>

			<div class="row mb-3">
				<div class="col-md-12">
					{{ form_row(form.description, {'attr': {'class': 'form-control', 'rows': 4}}) }}
				</div>
			</div>

			<button type="submit" class="btn btn-danger">Ajouter le produit</button>

		{{ form_end(form) }}
	</div>

	<!-- LISTE DES PRODUITS -->
	<h3 class="mb-3 text-danger">üì¶ Produits existants</h3>

	{% if products is not empty %}
		<div class="table-responsive">
			<table class="table table-striped table-hover">
				<thead class="table-dark">
					<tr>
						<th>ID</th>
						<th>Nom</th>
						<th>Type</th>
						<th>Prix (‚Ç¨)</th>
						<th>Description</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody>
					{% for product in products %}
						<tr>
							<td><strong>{{ product.id }}</strong></td>
							<td>{{ product.name }}</td>
							<td>
								<span class="badge bg-info">
									{% if product.type.value == 'merch' %}
										Merchandising
									{% elseif product.type.value == 'accessoire' %}
										Accessoire
									{% elseif product.type.value == 'vetement' %}
										V√™tement
									{% else %}
										{{ product.type.value }}
									{% endif %}
								</span>
							</td>
							<td><strong class="text-danger">{{ product.price|number_format(2, ',', ' ') }}‚Ç¨</strong></td>
							<td>
								{% if product.description %}
									{% if product.description|length > 50 %}
										{{ product.description|slice(0, 50) }}...
									{% else %}
										{{ product.description }}
									{% endif %}
								{% else %}
									<em class="text-muted">Pas de description</em>
								{% endif %}
							</td>
							<td>
								<a href="{{ path('store_edit', {'id': product.id}) }}" class="btn btn-sm btn-warning">‚úèÔ∏è Modifier</a>
								<a href="{{ path('store_delete', {'id': product.id}) }}" class="btn btn-sm btn-danger" onclick="return confirm('√ätes-vous s√ªr ?')">üóëÔ∏è Supprimer</a>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
	{% else %}
		<div class="alert alert-info" role="alert">
			Aucun produit pour le moment. Cr√©ez le premier ci-dessus !
		</div>
	{% endif %}
{% endblock %}
