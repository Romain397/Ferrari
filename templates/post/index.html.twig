{% extends 'base.html.twig' %}

{% block title %}Accueil
{% endblock %}


{% block main %}
	<h1 class="mb-4 text-center">{{ 'ferrari – histoire & héritage'|upper }}</h1>

	<p class="text-center mb-5">
		Ferrari est une marque emblématique du sport automobile, fondée par Enzo Ferrari.
							    Présente en endurance et en Formule 1, la Scuderia incarne la performance et la passion.
	</p>

	<h2 class="mb-4">Voitures emblématiques</h2>

	<div class="row g-4">
		{% for post in posts %}
			<div class="col-md-4">
				<div class="card {% if post.highlight %}highlight{% endif %} h-100 position-relative">

					{% if post.image %}
						<img
							src="{{ post.image|optimized_image_url(640) }}"
							class="card-img-top rounded-4"
							alt="{{ post.model }}"
							width="640"
							height="360"
							sizes="(min-width: 1200px) 413px, (min-width: 768px) 320px, 96vw"
							loading="{{ loop.first ? 'eager' : 'lazy' }}"
							fetchpriority="{{ loop.first ? 'high' : 'auto' }}"
							decoding="async"
						>
					{% endif %}

					<div class="card-body d-flex flex-column">
						<h3>{{ post.title }}
							<small class="text-warning">({{ post.model }})</small>
						</h3>

						{% if post.content %}
							<p class="flex-grow-1">{{ post.content }}</p>
						{% endif %}

						<p class="text-warning mb-2">Année :
							{{ post.year }}</p>

						{% if post.video %}
							{% set youtubeEmbed = post.video|replace({'https://youtu.be/': 'https://www.youtube.com/embed/'}) %}
							<div class="ratio ratio-16x9 mt-2">
								<iframe src="{{ youtubeEmbed }}" title="Vidéo {{ post.model }}" allowfullscreen></iframe>
							</div>
						{% endif %}

						{% if post.circuitImage %}
							<img
								src="{{ post.circuitImage|optimized_image_url(640) }}"
								alt="Circuit {{ post.title }}"
								class="img-fluid rounded-3 mt-3"
								width="640"
								height="360"
								loading="lazy"
								decoding="async"
							>
						{% endif %}
					</div>

					{% if post.highlight %}
						<div class="badge bg-danger position-absolute top-0 start-50 translate-middle-x mt-2 px-3 py-2 fs-6 rounded-pill shadow">À la une ⭐</div>
					{% endif %}
				</div>
			</div>
		{% else %}
			<p class="text-center">Aucune voiture enregistrée pour le moment.</p>
		{% endfor %}
	</div>


	<p class="summary mt-5 text-center">
		Nombre de modèles présentés :
		<strong>{{ posts|length }}</strong>
	</p>
{% endblock %}

